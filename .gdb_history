c
b woodywood_pack
r Ressources/sample
n
p *(Elf64_Shdr *)$rax
b woodywood_pack
r Ressources/sample
n
b get_section64_with_e 
r Ressources/sample
c
n
n
p entry
p (void *) + shdr->sh_offset 
p (void *)hdr + shdr->sh_offset 
pd
p hdr
p *hdr
b woodywood_pack
r Ressources/sample
n
si
b get_section64_with_e 
r Ressources/sample
n
n
p shdr->sh_offset 
n
p shdr->sh_offset 
n
p shdr->sh_offset 
n
p shdr->sh_offset 
n
n
n
p shdr->sh_offset 
n
p shdr->sh_offset 
n
b woodywood_pack
r Ressources/sample
n
b *(Elf_Shdr *)$rax
b *(Elf64_Shdr *)$rax
p *(Elf64_Shdr *)$rax
b insert_code 
r Ressources/sample
n
(void *)shell_str + shell_symtab->st_name
p (void *)shell_str + shell_symtab->st_name
p (char *)shell_str + shell_symtab->st_name
p (char *)shell_str + 1
p (char *)shell_str + 2
p (char *)shell_str + 3
p (char *)shell_str + 7
man elf
make
make
clear
make
make
make
make
make
clear
make
make
ls
b insert_code
r Ressources/sample
n
p (char *)((void *)shell_str + ((Elf64_Shdr *)((void *)shellcode + shell_str->sh_offset))->sh_name)
r Ressources/sample
n
n
n
n
p shell_str
p *shell_str
p *shell_symtab
p (Elf64_Shdr *)shell_symtab
p *(Elf64_Shdr *)shell_symtab
b insert_code
r Ressources/sample
n
p shell_symab
p shell_symtab
p *shell_symtab
p *(shell_symtab + sizeof(Elf64_Sym)
p *(shell_symtab + sizeof(Elf64_Sym))
p *((void *)shell_symtab + sizeof(Elf64_Sym))
p *(Elf64_Sym)((void *)shell_symtab + sizeof(Elf64_Sym))
p *(Elf64_Sym *)((void *)shell_symtab + sizeof(Elf64_Sym))
p *(Elf64_Sym *)((void *)shell_symtab + 2 * sizeof(Elf64_Sym))
p *(Elf64_Sym *)((void *)shell_symtab + 3 * sizeof(Elf64_Sym))
p *(Elf64_Sym *)((void *)shell_symtab + 4 * sizeof(Elf64_Sym))
n
b insert_code 
r Ressources/sample
n
p shell_symtabhdr 
p *shell_symtabhdr 
p *shell_symtab
n
p *shell_symtab
clear
b inser_code
b insert_code
r Ressources/sample
n
(void *)hdr + to_decrypt->sh_offset
p (void *)hdr + to_decrypt->sh_offset
p (void *)hdr + to_decrypt->sh_offset
r Ressources/sample
p (void *)hdr + to_decrypt->sh_offset
p (void *)hdr + to_decrypt->sh_offset
r Ressources/sample
p (void *)hdr + to_decrypt->sh_offset
p *((void *)hdr + to_decrypt->sh_offset)
p *((unsigned int *)hdr + to_decrypt->sh_offset)
r Ressources/sample
p *((unsigned int *)hdr + to_decrypt->sh_offset)
p *((unsigned int *)shellcode + to_decrypt->sh_offset + code_size)
p *((unsigned int *)shellcode + to_decrypt->sh_offset)
objdump -D woody
b insert_code
r Ressources/sample
p *((unsigned int *)shellcode + to_decrypt->sh_offset)
p *(unsigned int *)((void *)shellcode + to_decrypt->sh_offset)
p *(unsigned int )((void *)shellcode + to_decrypt->sh_offset)
b woodywood_pack
r Ressources/sample
n
n
p *to_encrypt 
x/256xb (void *)hdr + to_encrypt->sh_offset

x/8xb (void *)hdr + to_encrypt->sh_offset
n
n
n
x/8xb (void *)hdr + to_encrypt->sh_offset
n
n
n
n
n
n
n
n
n
n
x/8xb (void *)hdr + to_encrypt->sh_offset
x/8xb (void *)hdr + to_decrypt->sh_offset
p to_decrypt->sh_offset
r Ressources/sample
c
x/8xb (void *)hdr + to_encrypt->sh_offset
x/8xb (void *)hdr + to_dencrypt->sh_offset
x/8xb (void *)hdr + to_decrypt->sh_offset
x/8xb (void *)shellcode + to_decrypt->sh_offset + shell_symtab->st_name
x/8xb (void *)shellcode + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
n
n
n
n
n
x/8xb (void *)shellcode + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
clear
b insert_code
r Ressources/sample
x/8xb (void *)shellcode + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
x/8xb (void *)hdr + to_encrypt->sh_offset
x/8xb (void *)hdr + to_decrypt->sh_offset
n
n
n
x/8xb (void *)hdr + to_decrypt->sh_offset
x/8xb (void *)shellcode + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
x/8xb (void *)woody_ptr + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
x/356xb (void *)woody_ptr + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
x/256xb (void *)woody_ptr + to_decrypt->sh_offset + shell_symtab->st_name + code_size 
x/256xb (void *)woody_ptr + to_decrypt->sh_offset + shell_symtab->st_name 
p to_decrypt->sh_offset - shell_symtab->st_name 
p shell_symtab->st_name 
x/256xb (void *)woody_ptr + to_decrypt->sh_offset + shell_symtab->st_st_value
x/256xb (void *)woody_ptr + to_decrypt->sh_offset + shell_symtab->st_value
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
x/8xb (void *)shellcode + to_decrypt->sh_offset + shell_symtab->st_value
p decr_offset 
p *decr_offset 
p (unsigned int)decr_offset 
p (unsigned int)code_size +
p (int)decr_offset 
p shell_symtab->st_value
r
b 00000000004003c8
b 0x00000000004003c8
b *0x00000000004003c8
r
b *0x0000000000600ff8
r
si
b *0x7fd5d0decca0
r
r
r
x/128xb 0x7fd5d0decca0
x/128xb *0x7fd5d0decca0
x/128xb 0x7fd5d0decca0 - 128
b woodywood_pack
r Ressources/sample
n
x/128xb (void *)woody_ptr + ((Elf64_Ehdr *)woody_ptr)->e_entry
p ((Elf64_Ehdr *)woody_ptr)->e_entry
x/128xb (void *)woody_ptr
b woodywood_pack
r Ressources/sample
n
n
n
n
n
n
n
x/128xb (void *)woody_ptr
x/128xb (void *)woody_ptr + ((Elf64_Ehdr *)woody_ptr)->e_entry
b *0x00000000004003c8
r
r
r
r
r
pdisas
b *(0x601038 + 0x33)
r
n
