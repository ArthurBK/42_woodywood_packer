r
r
r
r
pdisas
b *(0x601038 + 0x33)
r
n
clear
b 0x601038 + 0x33
b *0x601038 + 0x33
r
b *0x601038 + 0x33
r
file
b *0x601038 + 0x33
r
n
p $xmm11
p $rip+0xffffffffffffffc2
p 0x601053
x/128xb 0x601053
make
make
man printf 
make
make
make
clear
b *0x601038 + 0x33
r
n
p $xmm11
searchmem 0x417357666a44356e
searchmem 0x41
searchmem 0x6e35
searchmem 0x6e
searchmem 0x356e
p $xmm11
r Ressources/sample
r Ressources/sample
b insert_code
b woodywood_pack
r
r Ressources/sample
n
p shellcode + shell_symtab->st_value
p *(shellcode + shell_symtab->st_value)
p *((char *)shellcode + shell_symtab->st_value)
0x33 0x71 0x36 0x6a 0x6d 0x76 0x48 0x39 0x49 0x4c 0x4e 0x71 0x68 0x70 0x4b 0x41
p *(char *)(shellcode + shell_symtab->st_value)
p *((int *)(shellcode + shell_symtab->st_value))
p *((long int *)(shellcode + shell_symtab->st_value))
0x3948766d6a367133
p shell_symtab->st_value
n
p *woody_ptr
b woodywood_pack
r Ressources/sample
n
p key
p (long int *)key
p *(long int *)key
p *woody_ptr last_Phdr->p_offset
p *woody_ptr + last_Phdr->p_offset
p woody_ptr + last_Phdr->p_offset
x/128xb woody_ptr + last_Phdr->p_offset + last_Phdr->p_filesz + padding_len 
searchmem 0x4b354f4d456c3158
make
make
b woodywood_pack:96
r Ressources/sample
clear
b insert_code
b woodywood_pack
r Ressources/sample
n
p shell_symtab->st_value 
p shellcode
p shellcode + 0xf
p (long int)(shellcode + 0xf)
p (long int *)(shellcode + 0xf)
p *(long int *)(shellcode + 0xf)
searchmem 0x766933344b63576a
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
searchmem 0x766933344b63576a
searchmem 0x766933344b63576a
b insert_code
b woodywood_pack
r Ressources/sample
n
p *(unsigned long*)0x55555575a610
searchmem 0x4741677a55343443
n
searchmem 0x4741677a55343443
n
searchmem 0x4741677a55343443
n
n
searchmem 0x4741677a55343443
p *woody_ptr 
p woody_ptr 
p woody_ptr + packed_size 
b insert_code
b woodywood_pack
r
r Ressources/sample
c
n
searchmem 0x55555575a610
c
r Ressources/sample
c
searchmem 0x55555575a610
n
searchmem 0x55555575a610
n
searchmem 0x55555575a610
p woody_ptr
p woody_ptr + packed_size 


p woody_ptr + packed_size + padding_len 
p woody_ptr + last_Phdr->p_offset 
p woody_ptr + last_Phdr->p_offset + last_Phdr->p_filesz 
make
r Ressources/sample
b woodywood_pack
r Ressources/sample
b woodywood_pack
r Ressources/sample
n
searchmem kG2BKZaBUKKt2QbJ
n
searchmem kG2BKZaBUKKt2QbJ
p woody_ptr 
p woody_ptr + packed_size 
c
searchmem kG2BKZaBUKKt2QbJ
b 0x601038 + 0x33
b *0x601038 + 0x33
r
n
p $xmm11

searchmem "kG2BKZaBUKKt2QbJ"
searchmem kG2BKZaBUKKt2QbJ
n
b *0x601038 + 0x33
r
n
r
n
p rip+0xffffffffffffffc2
p $rip+0xffffffffffffffc2
p *0x60105f
r
n
p *0x60105f
p *(long int*)0x60105f
p *0xfffff39d
p *0x7fffffff39d
p *0x7fffffffff39d
p *0x7ffffffff39d
p *0x7fffffff39d
b *0x601038 + 0x33
r
n
b *0x601038 + 0x33
r
n
b *0x601038 + 0x33
r
b *0x601038 + 0x33
r
b *0x601038 + 0x37
r
n
b *0x601038 + 0x37
r
n
p 0x00601cae
p *0x00601cae
x/128xb 0x00601cae
x/128xb 0xffffffff00601cae
searchmem 0x3680c198
searchmem 0x98
searchmem 0x36
searchmem 0x71d1c73e98c18036
clear
searchmem 0x71d1c73e98c18036
n
searchmem 0x71d1c73e98c18036
set $rdi=0x600400
n
searchmem 0x71d1c73e98c18036
n
n
n
n
p $smm14
p $xmm14
b *0x601038 + 0x37
r
n
searchmem 0x71d1c73e98c18036
n
searchmem 0x71d1c73e98c18036
n
searchmem 0x71d1c73e98c18036
:x
searchmem 0x48f940
searchmem 0x48f94004ba
r
n
make
r
x/128b 0x601072
make
r
b *0x601038 + 0x43
r
n
n
p $smm14
p $xmm14
p *0x600400
set *0x600400=$xmm14
r
r
pdisas
readelf
readelf -h
r
